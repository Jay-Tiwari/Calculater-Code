<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculator</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <div class="calculator">
      <div class="top-bar">
        <button id="themeToggle">ðŸŒž</button>
        <button id="showHistory">ðŸ“œ History</button>
      </div>
      <div id="display" class="display">0</div>
      <div class="buttons">
        <button class="number">7</button>
        <button class="number">8</button>
        <button class="number">9</button>
        <button class="operator">Ã·</button>

        <button class="number">4</button>
        <button class="number">5</button>
        <button class="number">6</button>
        <button class="operator">Ã—</button>

        <button class="number">1</button>
        <button class="number">2</button>
        <button class="number">3</button>
        <button class="operator">-</button>

        <button class="number">.</button>
        <button class="number">0</button>
        <button class="number">00</button>
        <button class="operator">+</button>

        <button class="clear">C</button>
        <button class="all-clear">AC</button>
        <button class="equal">=</button>
      </div>
    </div>
    <div class="history">
      <h2>History</h2>
      <ul id="historyList"></ul>
    </div>
  </div>

  <script>
    const display = document.getElementById("display");
    const buttons = document.querySelectorAll(".buttons button");
    const historyList = document.getElementById("historyList");
    const themeBtn = document.getElementById("themeToggle");
    const historyBtn = document.getElementById("showHistory");

    let currentInput = "0";
    let history = [];
    let darkMode = true;

    function updateDisplay() {
      display.textContent = currentInput;
    }

    function addToHistory(entry) {
      history.push(entry);
      const li = document.createElement("li");
      li.textContent = entry;
      historyList.appendChild(li);
    }

    function handleInput(value) {
      if (/[\d.]/.test(value)) {
        if (currentInput === "0") currentInput = value;
        else currentInput += value;
      } else if (["+", "-", "Ã—", "Ã·", "*", "/"].includes(value)) {
        if (value === "*") value = "Ã—";
        if (value === "/") value = "Ã·";
        currentInput += value;
      } else if (value === "Backspace") {
        currentInput = currentInput.slice(0, -1) || "0";
      } else if (value === "Escape") {
        currentInput = "0";
      } else if (value === "Delete") {
        currentInput = "0";
      } else if (value === "Enter" || value === "=") {
        try {
          const expression = currentInput.replace(/Ã—/g, "*").replace(/Ã·/g, "/");
          const result = eval(expression);
          addToHistory(currentInput + " = " + result);
          currentInput = result.toString();
        } catch {
          currentInput = "Error";
        }
      }
      updateDisplay();
    }

    // Button clicks
    buttons.forEach(btn => {
      btn.addEventListener("click", () => {
        const value = btn.textContent;
        if (btn.classList.contains("number") || btn.classList.contains("operator")) {
          if (currentInput === "0") currentInput = value;
          else currentInput += value;
        } else if (btn.classList.contains("clear")) {
          currentInput = currentInput.slice(0, -1) || "0";
        } else if (btn.classList.contains("all-clear")) {
          currentInput = "0";
        } else if (btn.classList.contains("equal")) {
          try {
            const expression = currentInput.replace(/Ã—/g, "*").replace(/Ã·/g, "/");
            const result = eval(expression);
            addToHistory(currentInput + " = " + result);
            currentInput = result.toString();
          } catch {
            currentInput = "Error";
          }
        }
        updateDisplay();
      });
    });

    // Keyboard input (supports numpad)
    document.addEventListener("keydown", (e) => {
      handleInput(e.key);
    });

    // Theme toggle
    themeBtn.addEventListener("click", () => {
      darkMode = !darkMode;
      document.body.classList.toggle("light-theme", !darkMode);
      themeBtn.textContent = darkMode ? "ðŸŒž" : "ðŸŒ™";
    });

    // Mobile history modal
    historyBtn.addEventListener("click", () => {
      const modal = document.createElement("div");
      modal.style.position = "fixed";
      modal.style.left = "0";
      modal.style.right = "0";
      modal.style.bottom = "0";
      modal.style.maxHeight = "60%";
      modal.style.background = getComputedStyle(document.body).backgroundColor;
      modal.style.color = getComputedStyle(document.body).color;
      modal.style.borderTop = "2px solid #666";
      modal.style.borderRadius = "20px 20px 0 0";
      modal.style.overflowY = "auto";
      modal.style.padding = "16px";
      modal.innerHTML = `<h2>History</h2><hr><ul>${historyList.innerHTML}</ul>
        <button style="margin-top:10px;width:100%;padding:10px;border:none;
          border-radius:12px;background:#444;color:white;font-size:18px;cursor:pointer;">
          Close
        </button>`;

      document.body.appendChild(modal);
      modal.querySelector("button").onclick = () => modal.remove();
    });

    updateDisplay();
  </script>
</body>
</html>
